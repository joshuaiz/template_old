function updateViewportDimensions(){var e=window,o=document,i=o.documentElement,t=o.getElementsByTagName("body")[0],n=e.innerWidth||i.clientWidth||t.clientWidth,r=e.innerHeight||i.clientHeight||t.clientHeight;return{width:n,height:r}}function loadGravatars(){viewport=updateViewportDimensions(),viewport.width>=768&&jQuery(".comment img[data-gravatar]").each(function(){jQuery(this).attr("src",jQuery(this).attr("data-gravatar"))})}var cssua=function(e,o,i){var t=/\s*([\-\w ]+)[\s\/\:]([\d_]+\b(?:[\-\._\/]\w+)*)/,n=/([\w\-\.]+[\s\/][v]?[\d_]+\b(?:[\-\._\/]\w+)*)/g,r=/\b(?:(blackberry\w*|bb10)|(rim tablet os))(?:\/(\d+\.\d+(?:\.\w+)*))?/,s=/\bsilk-accelerated=true\b/,l=/\bfluidapp\b/,d=/(\bwindows\b|\bmacintosh\b|\blinux\b|\bunix\b)/,p=/(\bandroid\b|\bipad\b|\bipod\b|\bwindows phone\b|\bwpdesktop\b|\bxblwp7\b|\bzunewp7\b|\bwindows ce\b|\bblackberry\w*|\bbb10\b|\brim tablet os\b|\bmeego|\bwebos\b|\bpalm|\bsymbian|\bj2me\b|\bdocomo\b|\bpda\b|\bchtml\b|\bmidp\b|\bcldc\b|\w*?mobile\w*?|\w*?phone\w*?)/,a=/(\bxbox\b|\bplaystation\b|\bnintendo\s+\w+)/,c={parse:function(e,o){var i={};if(o&&(i.standalone=o),e=(""+e).toLowerCase(),!e)return i;for(var c,x,u=e.split(/[()]/),b=0,f=u.length;f>b;b++)if(b%2){var m=u[b].split(";");for(c=0,x=m.length;x>c;c++)if(t.exec(m[c])){var g=RegExp.$1.split(" ").join("_"),w=RegExp.$2;(!i[g]||parseFloat(i[g])<parseFloat(w))&&(i[g]=w)}}else if(m=u[b].match(n))for(c=0,x=m.length;x>c;c++)g=m[c].split(/[\/\s]+/),g.length&&"mozilla"!==g[0]&&(i[g[0].split(" ").join("_")]=g.slice(1).join("-"));return p.exec(e)?(i.mobile=RegExp.$1,r.exec(e)&&(delete i[i.mobile],i.blackberry=i.version||RegExp.$3||RegExp.$2||RegExp.$1,RegExp.$1?i.mobile="blackberry":"0.0.1"===i.version&&(i.blackberry="7.1.0.0"))):d.exec(e)?i.desktop=RegExp.$1:a.exec(e)&&(i.game=RegExp.$1,c=i.game.split(" ").join("_"),i.version&&!i[c]&&(i[c]=i.version)),i.intel_mac_os_x?(i.mac_os_x=i.intel_mac_os_x.split("_").join("."),delete i.intel_mac_os_x):i.cpu_iphone_os?(i.ios=i.cpu_iphone_os.split("_").join("."),delete i.cpu_iphone_os):i.cpu_os?(i.ios=i.cpu_os.split("_").join("."),delete i.cpu_os):"iphone"!==i.mobile||i.ios||(i.ios="1"),i.opera&&i.version?(i.opera=i.version,delete i.blackberry):s.exec(e)?i.silk_accelerated=!0:l.exec(e)&&(i.fluidapp=i.version),i.applewebkit?(i.webkit=i.applewebkit,delete i.applewebkit,i.opr&&(i.opera=i.opr,delete i.opr,delete i.chrome),i.safari&&(i.chrome||i.crios||i.opera||i.silk||i.fluidapp||i.phantomjs||i.mobile&&!i.ios?delete i.safari:i.safari=i.version&&!i.rim_tablet_os?i.version:{419:"2.0.4",417:"2.0.3",416:"2.0.2",412:"2.0",312:"1.3",125:"1.2",85:"1.0"}[parseInt(i.safari,10)]||i.safari)):i.msie||i.trident?(i.opera||(i.ie=i.msie||i.rv),delete i.msie,i.windows_phone_os?(i.windows_phone=i.windows_phone_os,delete i.windows_phone_os):("wpdesktop"===i.mobile||"xblwp7"===i.mobile||"zunewp7"===i.mobile)&&(i.mobile="windows desktop",i.windows_phone=9>+i.ie?"7.0":10>+i.ie?"7.5":"8.0",delete i.windows_nt)):(i.gecko||i.firefox)&&(i.gecko=i.rv),i.rv&&delete i.rv,i.version&&delete i.version,i},format:function(e){var o="",i;for(i in e)if(i&&e.hasOwnProperty(i)){var t=i,n=e[i],t=t.split(".").join("-"),r=" ua-"+t;if("string"==typeof n){for(var n=n.split(" ").join("_").split(".").join("-"),s=n.indexOf("-");s>0;)r+=" ua-"+t+"-"+n.substring(0,s),s=n.indexOf("-",s+1);r+=" ua-"+t+"-"+n}o+=r}return o},encode:function(e){var o="",i;for(i in e)i&&e.hasOwnProperty(i)&&(o&&(o+="&"),o+=encodeURIComponent(i)+"="+encodeURIComponent(e[i]));return o}};return c.userAgent=c.ua=c.parse(o,i),o=c.format(c.ua)+" js",e.className=e.className?e.className.replace(/\bno-js\b/g,"")+o:o.substr(1),c}(document.documentElement,navigator.userAgent,navigator.standalone);!function(e){e.isScrollToFixed=function(o){return!!e(o).data("ScrollToFixed")},e.ScrollToFixed=function(o,i){function t(){w.trigger("preUnfixed.ScrollToFixed"),a(),w.trigger("unfixed.ScrollToFixed"),k=-1,_=w.offset().top,y=w.offset().left,m.options.offsets&&(y+=w.offset().left-w.position().left),-1==j&&(j=y),h=w.css("position"),g=!0,-1!=m.options.bottom&&(w.trigger("preFixed.ScrollToFixed"),d(),w.trigger("fixed.ScrollToFixed"))}function n(){var e=m.options.limit;return e?"function"==typeof e?e.apply(w):e:0}function r(){return"fixed"===h}function s(){return"absolute"===h}function l(){return!(r()||s())}function d(){if(!r()){var e=w[0].getBoundingClientRect();C.css({display:w.css("display"),width:e.width,height:e.height,"float":w.css("float")}),cssOptions={"z-index":m.options.zIndex,position:"fixed",top:-1==m.options.bottom?x():"",bottom:-1==m.options.bottom?"":m.options.bottom,"margin-left":"0px"},m.options.dontSetWidth||(cssOptions.width=w.css("width")),w.css(cssOptions),w.addClass(m.options.baseClassName),m.options.className&&w.addClass(m.options.className),h="fixed"}}function p(){var e=n(),o=y;m.options.removeOffsets&&(o="",e-=_),cssOptions={position:"absolute",top:e,left:o,"margin-left":"0px",bottom:""},m.options.dontSetWidth||(cssOptions.width=w.css("width")),w.css(cssOptions),h="absolute"}function a(){l()||(k=-1,C.css("display","none"),w.css({"z-index":S,width:"",position:v,left:"",top:T,"margin-left":""}),w.removeClass("scroll-to-fixed-fixed"),m.options.className&&w.removeClass(m.options.className),h=null)}function c(e){e!=k&&(w.css("left",y-e),k=e)}function x(){var e=m.options.marginTop;return e?"function"==typeof e?e.apply(w):e:0}function u(){if(e.isScrollToFixed(w)&&!w.is(":hidden")){var o=g,i=l();g?l()&&(_=w.offset().top,y=w.offset().left):t();var u=e(window).scrollLeft(),h=e(window).scrollTop(),F=n();m.options.minWidth&&e(window).width()<m.options.minWidth?l()&&o||(f(),w.trigger("preUnfixed.ScrollToFixed"),a(),w.trigger("unfixed.ScrollToFixed")):m.options.maxWidth&&e(window).width()>m.options.maxWidth?l()&&o||(f(),w.trigger("preUnfixed.ScrollToFixed"),a(),w.trigger("unfixed.ScrollToFixed")):-1==m.options.bottom?F>0&&h>=F-x()?i||s()&&o||(f(),w.trigger("preAbsolute.ScrollToFixed"),p(),w.trigger("unfixed.ScrollToFixed")):h>=_-x()?(r()&&o||(f(),w.trigger("preFixed.ScrollToFixed"),d(),k=-1,w.trigger("fixed.ScrollToFixed")),c(u)):l()&&o||(f(),w.trigger("preUnfixed.ScrollToFixed"),a(),w.trigger("unfixed.ScrollToFixed")):F>0?h+e(window).height()-w.outerHeight(!0)>=F-(x()||-b())?r()&&(f(),w.trigger("preUnfixed.ScrollToFixed"),"absolute"===v?p():a(),w.trigger("unfixed.ScrollToFixed")):(r()||(f(),w.trigger("preFixed.ScrollToFixed"),d()),c(u),w.trigger("fixed.ScrollToFixed")):c(u)}}function b(){return m.options.bottom?m.options.bottom:0}function f(){var e=w.css("position");"absolute"==e?w.trigger("postAbsolute.ScrollToFixed"):"fixed"==e?w.trigger("postFixed.ScrollToFixed"):w.trigger("postUnfixed.ScrollToFixed")}var m=this;m.$el=e(o),m.el=o,m.$el.data("ScrollToFixed",m);var g=!1,w=m.$el,h,v,F,T,S,_=0,y=0,j=-1,k=-1,C=null,U,E,R=function(e){w.is(":visible")&&(g=!1,u())},z=function(e){window.requestAnimationFrame?requestAnimationFrame(u):u()},O=function(){var e=document.body;if(document.createElement&&e&&e.appendChild&&e.removeChild){var o=document.createElement("div");if(!o.getBoundingClientRect)return null;o.innerHTML="x",o.style.cssText="position:fixed;top:100px;",e.appendChild(o);var i=e.style.height,t=e.scrollTop;e.style.height="3000px",e.scrollTop=500;var n=o.getBoundingClientRect().top;e.style.height=i;var r=100===n;return e.removeChild(o),e.scrollTop=t,r}return null},A=function(e){e=e||window.event,e.preventDefault&&e.preventDefault(),e.returnValue=!1};m.init=function(){m.options=e.extend({},e.ScrollToFixed.defaultOptions,i),S=w.css("z-index"),m.$el.css("z-index",m.options.zIndex),C=e("<div />"),h=w.css("position"),v=w.css("position"),F=w.css("float"),T=w.css("top"),l()&&m.$el.after(C),e(window).bind("resize.ScrollToFixed",R),e(window).bind("scroll.ScrollToFixed",z),"ontouchmove"in window&&e(window).bind("touchmove.ScrollToFixed",u),m.options.preFixed&&w.bind("preFixed.ScrollToFixed",m.options.preFixed),m.options.postFixed&&w.bind("postFixed.ScrollToFixed",m.options.postFixed),m.options.preUnfixed&&w.bind("preUnfixed.ScrollToFixed",m.options.preUnfixed),m.options.postUnfixed&&w.bind("postUnfixed.ScrollToFixed",m.options.postUnfixed),m.options.preAbsolute&&w.bind("preAbsolute.ScrollToFixed",m.options.preAbsolute),m.options.postAbsolute&&w.bind("postAbsolute.ScrollToFixed",m.options.postAbsolute),m.options.fixed&&w.bind("fixed.ScrollToFixed",m.options.fixed),m.options.unfixed&&w.bind("unfixed.ScrollToFixed",m.options.unfixed),m.options.spacerClass&&C.addClass(m.options.spacerClass),w.bind("resize.ScrollToFixed",function(){C.height(w.height())}),w.bind("scroll.ScrollToFixed",function(){w.trigger("preUnfixed.ScrollToFixed"),a(),w.trigger("unfixed.ScrollToFixed"),u()}),w.bind("detach.ScrollToFixed",function(o){A(o),w.trigger("preUnfixed.ScrollToFixed"),a(),w.trigger("unfixed.ScrollToFixed"),e(window).unbind("resize.ScrollToFixed",R),e(window).unbind("scroll.ScrollToFixed",z),w.unbind(".ScrollToFixed"),C.remove(),m.$el.removeData("ScrollToFixed")}),R()},m.init()},e.ScrollToFixed.defaultOptions={marginTop:0,limit:0,bottom:-1,zIndex:1e3,baseClassName:"scroll-to-fixed-fixed"},e.fn.scrollToFixed=function(o){return this.each(function(){new e.ScrollToFixed(this,o)})}}(jQuery);var viewport=updateViewportDimensions(),waitForFinalEvent=function(){var e={};return function(o,i,t){t||(t="Don't call this twice without a uniqueId"),e[t]&&clearTimeout(e[t]),e[t]=setTimeout(o,i)}}(),timeToWaitForLast=100;jQuery(document).ready(function($){loadGravatars(),viewport=updateViewportDimensions(),viewport.width>=768&&$("header.header").scrollToFixed()});